Postgres is up - executing command
Server.js is being executed!
API_KEY_ENCRYPTION_KEY is not defined in .env. Please set it for security.
Conexão com o banco de dados estabelecida com sucesso (Sequelize).
Server is running on port 5000
Agendador de relatório diário iniciado. A tarefa será executada todos os dias às 8:00.
Agendador de lembrete de cupons iniciado. A tarefa será executada todos os dias às 9:00.
Executing (default): SELECT "Pesquisa"."id", "Pesquisa"."title", "Pesquisa"."description", "Pesquisa"."createdAt", "Pesquisa"."updatedAt", "Pesquisa"."isOpen", "Pesquisa"."tenantId", "Pesquisa"."askForAttendant", "Pesquisa"."status", "Pesquisa"."recompensaId", "Pesquisa"."roletaId", "perguntas"."id" AS "perguntas.id", "perguntas"."type" AS "perguntas.type", "perguntas"."text" AS "perguntas.text", "perguntas"."options" AS "perguntas.options", "perguntas"."order" AS "perguntas.order", "perguntas"."required" AS "perguntas.required", "tenant"."id" AS "tenant.id", "tenant"."name" AS "tenant.name", "tenant"."logoUrl" AS "tenant.logoUrl", "tenant"."description" AS "tenant.description", "tenant"."primaryColor" AS "tenant.primaryColor", "tenant"."secondaryColor" AS "tenant.secondaryColor", "roleta"."id" AS "roleta.id", "roleta"."nome" AS "roleta.nome", "roleta"."descricao" AS "roleta.descricao", "roleta"."active" AS "roleta.active" FROM "pesquisas" AS "Pesquisa" LEFT OUTER JOIN "perguntas" AS "perguntas" ON "Pesquisa"."id" = "perguntas"."pesquisaId" LEFT OUTER JOIN "tenants" AS "tenant" ON "Pesquisa"."tenantId" = "tenant"."id" LEFT OUTER JOIN "roletas" AS "roleta" ON "Pesquisa"."roletaId" = "roleta"."id" WHERE "Pesquisa"."id" = 'b56d81f7-cd09-438b-b9b9-b54e1cbef49f';
[Auth Middleware] Request: POST /api/auth/verify-token
Executing (default): SELECT "id", "name", "address", "phone", "email", "logoUrl", "primaryColor", "secondaryColor", "description", "website", "cnpj", "inscricaoEstadual", "reportPhoneNumber", "createdAt", "updatedAt" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '00055233-b221-4eaa-8e8b-7c14d02d221c';
Executing (default): SELECT "id", "name" FROM "atendentes" AS "Atendente" WHERE "Atendente"."tenantId" = '00055233-b221-4eaa-8e8b-7c14d02d221c' AND "Atendente"."status" = 'active' ORDER BY "Atendente"."name" ASC;
Executing (b2f3fe67-6aac-4051-8f92-40558d5024a7): SELECT "Pesquisa"."id", "Pesquisa"."isOpen", "Pesquisa"."tenantId", "Pesquisa"."askForAttendant", "Pesquisa"."title", "perguntas"."id" AS "perguntas.id", "perguntas"."type" AS "perguntas.type", "perguntas"."options" AS "perguntas.options", "perguntas"."required" AS "perguntas.required", "perguntas"."text" AS "perguntas.text" FROM "pesquisas" AS "Pesquisa" LEFT OUTER JOIN "perguntas" AS "perguntas" ON "Pesquisa"."id" = "perguntas"."pesquisaId" WHERE "Pesquisa"."id" = 'b56d81f7-cd09-438b-b9b9-b54e1cbef49f';
Executing (b2f3fe67-6aac-4051-8f92-40558d5024a7): INSERT INTO "respostas" ("id","perguntaId","pesquisaId","tenantId","atendenteId","respondentSessionId","ratingValue","textValue","createdAt","updatedAt","selectedOption") VALUES ('f9a13de5-3b48-4bd7-9c61-a09ebb5ba3b2','22e1cef6-15c1-45bc-a319-ac83a09c9b43','b56d81f7-cd09-438b-b9b9-b54e1cbef49f','00055233-b221-4eaa-8e8b-7c14d02d221c','9cf0ba4d-8daa-42bf-82f2-7a77a777c7e3','1db28272-e152-4b79-a63e-c8c3933cc4ca',5,NULL,'2025-10-10 17:33:19.402 +00:00','2025-10-10 17:33:19.402 +00:00',NULL),('49cac5e3-a44a-4272-9fd6-1e27ec59a439','f10756da-40a7-42b9-9121-141d37f5d5bc','b56d81f7-cd09-438b-b9b9-b54e1cbef49f','00055233-b221-4eaa-8e8b-7c14d02d221c','9cf0ba4d-8daa-42bf-82f2-7a77a777c7e3','1db28272-e152-4b79-a63e-c8c3933cc4ca',NULL,NULL,'2025-10-10 17:33:19.402 +00:00','2025-10-10 17:33:19.402 +00:00','a'),('6dc9790e-489b-488d-9f0b-2e1af4a2309e','74c8d1fc-17d8-44a1-bdf3-8ac42e90b595','b56d81f7-cd09-438b-b9b9-b54e1cbef49f','00055233-b221-4eaa-8e8b-7c14d02d221c','9cf0ba4d-8daa-42bf-82f2-7a77a777c7e3','1db28272-e152-4b79-a63e-c8c3933cc4ca',5,NULL,'2025-10-10 17:33:19.402 +00:00','2025-10-10 17:33:19.402 +00:00',NULL),('6cecbf32-156c-414b-9542-65c599bbf688','c5b5bb51-b01a-41ad-be0e-8410b5a6903d','b56d81f7-cd09-438b-b9b9-b54e1cbef49f','00055233-b221-4eaa-8e8b-7c14d02d221c','9cf0ba4d-8daa-42bf-82f2-7a77a777c7e3','1db28272-e152-4b79-a63e-c8c3933cc4ca',NULL,NULL,'2025-10-10 17:33:19.402 +00:00','2025-10-10 17:33:19.402 +00:00','a'),('fae85d02-d5c9-425b-a236-019e2fdf314f','d4a9084f-9a4f-460b-bf02-35119f4b53a8','b56d81f7-cd09-438b-b9b9-b54e1cbef49f','00055233-b221-4eaa-8e8b-7c14d02d221c','9cf0ba4d-8daa-42bf-82f2-7a77a777c7e3','1db28272-e152-4b79-a63e-c8c3933cc4ca',9,NULL,'2025-10-10 17:33:19.402 +00:00','2025-10-10 17:33:19.402 +00:00',NULL) RETURNING "id","perguntaId","pesquisaId","tenantId","atendenteId","respondentSessionId","ratingValue","textValue","selectedOption","createdAt","updatedAt";
Executing (default): SELECT "id", "name", "address", "phone", "email", "logoUrl", "primaryColor", "secondaryColor", "description", "website", "cnpj", "inscricaoEstadual", "reportPhoneNumber", "createdAt", "updatedAt" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '00055233-b221-4eaa-8e8b-7c14d02d221c';
Executing (default): SELECT "id", "name", "logoUrl", "primaryColor", "secondaryColor", "description" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '00055233-b221-4eaa-8e8b-7c14d02d221c';
[Auth Middleware] Request: POST /api/auth/verify-token
Executing (default): SELECT "id", "name", "address", "phone", "email", "logoUrl", "primaryColor", "secondaryColor", "description", "website", "cnpj", "inscricaoEstadual", "reportPhoneNumber", "createdAt", "updatedAt" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '00055233-b221-4eaa-8e8b-7c14d02d221c';
[Auth Middleware] Request: POST /api/auth/verify-token
Executing (default): SELECT "id", "name", "address", "phone", "email", "logoUrl", "primaryColor", "secondaryColor", "description", "website", "cnpj", "inscricaoEstadual", "reportPhoneNumber", "createdAt", "updatedAt" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '00055233-b221-4eaa-8e8b-7c14d02d221c';
Executing (default): SELECT "id", "name", "logoUrl", "primaryColor", "secondaryColor", "description" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '00055233-b221-4eaa-8e8b-7c14d02d221c';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."phone" = '(35) 98989-8989';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."phone" = '(35) 99898-9898';