URL da solicitação
https://apivoltaki.towersfy.com/api/clients/register
Método da solicitação
POST
Código de status
500 Internal Server Error
Endereço remoto
95.217.16.187:443
{
    "status": "error",
    "code": "HTTP_500",
    "message": "Validation error",
    "details": "Error: Validation error\n    at /usr/src/app/src/controllers/clientController.js:99:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)"
}

  "perguntaId": "5f7acf91-90d6-44cd-963f-6f81effd5e1a",
  "tipo": "rating_1_5",
  "valor": 5,
  "comentario": ""
}
submitSurveyResponses: Question found: A pizza chegou quentinha e na consistência certa?
submitSurveyResponses: Response data prepared: {
  "pesquisaId": "87d63f62-4bb9-43e5-ab76-9eb004d4d2bb",
  "perguntaId": "5f7acf91-90d6-44cd-963f-6f81effd5e1a",
  "respondentSessionId": "a2b6775a-08f6-47db-a0a2-7ddc2343e323",
  "clienteId": null,
  "tenantId": "3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd",
  "atendenteId": "f60c5a4d-1c9a-474c-89db-2abd95e8e06f",
  "textValue": null,
  "ratingValue": 5
}
submitSurveyResponses: Processing response: {
  "perguntaId": "d5938446-234d-40c3-967c-050cb336aa06",
  "tipo": "rating_0_10",
  "valor": 10,
  "comentario": ""
}
submitSurveyResponses: Question found: De 0 a 10, qual a chance de você nos recomendar como a melhor pizzaria da cidade?
submitSurveyResponses: Response data prepared: {
  "pesquisaId": "87d63f62-4bb9-43e5-ab76-9eb004d4d2bb",
  "perguntaId": "d5938446-234d-40c3-967c-050cb336aa06",
  "respondentSessionId": "a2b6775a-08f6-47db-a0a2-7ddc2343e323",
  "clienteId": null,
  "tenantId": "3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd",
  "atendenteId": "f60c5a4d-1c9a-474c-89db-2abd95e8e06f",
  "textValue": null,
  "ratingValue": 10
}
submitSurveyResponses: Preparing to bulk create responses: [
  {
    "pesquisaId": "87d63f62-4bb9-43e5-ab76-9eb004d4d2bb",
    "perguntaId": "cc2c724c-3580-4f94-ab87-5822e4497770",
    "respondentSessionId": "a2b6775a-08f6-47db-a0a2-7ddc2343e323",
    "clienteId": null,
    "tenantId": "3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd",
    "atendenteId": "f60c5a4d-1c9a-474c-89db-2abd95e8e06f",
    "textValue": null,
    "ratingValue": 5
  },
  {
    "pesquisaId": "87d63f62-4bb9-43e5-ab76-9eb004d4d2bb",
    "perguntaId": "2ffb181f-141b-472d-9abd-3c51595c7f29",
    "respondentSessionId": "a2b6775a-08f6-47db-a0a2-7ddc2343e323",
    "clienteId": null,
    "tenantId": "3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd",
    "atendenteId": "f60c5a4d-1c9a-474c-89db-2abd95e8e06f",
    "textValue": null,
    "ratingValue": 5
  },
  {
    "pesquisaId": "87d63f62-4bb9-43e5-ab76-9eb004d4d2bb",
    "perguntaId": "5f7acf91-90d6-44cd-963f-6f81effd5e1a",
    "respondentSessionId": "a2b6775a-08f6-47db-a0a2-7ddc2343e323",
    "clienteId": null,
    "tenantId": "3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd",
    "atendenteId": "f60c5a4d-1c9a-474c-89db-2abd95e8e06f",
    "textValue": null,
    "ratingValue": 5
  },
  {
    "pesquisaId": "87d63f62-4bb9-43e5-ab76-9eb004d4d2bb",
    "perguntaId": "d5938446-234d-40c3-967c-050cb336aa06",
    "respondentSessionId": "a2b6775a-08f6-47db-a0a2-7ddc2343e323",
    "clienteId": null,
    "tenantId": "3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd",
    "atendenteId": "f60c5a4d-1c9a-474c-89db-2abd95e8e06f",
    "textValue": null,
    "ratingValue": 10
  }
]
Executing (bbf5ca0f-b0be-4b1f-bd7c-ef7f45960c42): INSERT INTO "respostas" ("id","perguntaId","pesquisaId","tenantId","atendenteId","respondentSessionId","ratingValue","textValue","createdAt","updatedAt") VALUES ('8ccce25b-7362-44f8-b3eb-23e0c0bfa67c','cc2c724c-3580-4f94-ab87-5822e4497770','87d63f62-4bb9-43e5-ab76-9eb004d4d2bb','3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd','f60c5a4d-1c9a-474c-89db-2abd95e8e06f','a2b6775a-08f6-47db-a0a2-7ddc2343e323',5,NULL,'2025-11-07 21:27:18.920 +00:00','2025-11-07 21:27:18.920 +00:00'),('6502f041-1c1b-4d7b-abac-c5b7f21f4f8d','2ffb181f-141b-472d-9abd-3c51595c7f29','87d63f62-4bb9-43e5-ab76-9eb004d4d2bb','3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd','f60c5a4d-1c9a-474c-89db-2abd95e8e06f','a2b6775a-08f6-47db-a0a2-7ddc2343e323',5,NULL,'2025-11-07 21:27:18.920 +00:00','2025-11-07 21:27:18.920 +00:00'),('e018cab3-275e-49b7-8bcb-2bbc76e889e0','5f7acf91-90d6-44cd-963f-6f81effd5e1a','87d63f62-4bb9-43e5-ab76-9eb004d4d2bb','3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd','f60c5a4d-1c9a-474c-89db-2abd95e8e06f','a2b6775a-08f6-47db-a0a2-7ddc2343e323',5,NULL,'2025-11-07 21:27:18.920 +00:00','2025-11-07 21:27:18.920 +00:00'),('89ddd351-62ae-44e4-8e92-268849b12856','d5938446-234d-40c3-967c-050cb336aa06','87d63f62-4bb9-43e5-ab76-9eb004d4d2bb','3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd','f60c5a4d-1c9a-474c-89db-2abd95e8e06f','a2b6775a-08f6-47db-a0a2-7ddc2343e323',10,NULL,'2025-11-07 21:27:18.920 +00:00','2025-11-07 21:27:18.920 +00:00') RETURNING "id","perguntaId","pesquisaId","tenantId","atendenteId","respondentSessionId","ratingValue","textValue","selectedOption","createdAt","updatedAt";
submitSurveyResponses: Bulk create successful
submitSurveyResponses: Transaction committed
submitSurveyResponses: All rating questions have max score. Checking for GMB link.
Executing (default): SELECT "gmb_link" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
submitSurveyResponses: GMB link found: https://search.google.com/local/writereview?placeid=ChIJcfyzAL_Hy5QR4eCg9WAT1LM
submitSurveyResponses: Checking for detractor responses for WhatsApp
submitSurveyResponses: Submission process finished successfully
Executing (default): SELECT "id", "name", "address", "phone", "email", "logoUrl", "primaryColor", "secondaryColor", "description", "website", "cnpj", "inscricaoEstadual", "reportPhoneNumber", "gmb_link", "createdAt", "updatedAt" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "id", "name", "logoUrl", "primaryColor", "secondaryColor", "description" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "id", "name", "logoUrl", "primaryColor", "secondaryColor", "description" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "Pesquisa"."id", "Pesquisa"."title", "Pesquisa"."description", "Pesquisa"."createdAt", "Pesquisa"."updatedAt", "Pesquisa"."isOpen", "Pesquisa"."tenantId", "Pesquisa"."askForAttendant", "Pesquisa"."status", "Pesquisa"."recompensaId", "Pesquisa"."roletaId", "perguntas"."id" AS "perguntas.id", "perguntas"."type" AS "perguntas.type", "perguntas"."text" AS "perguntas.text", "perguntas"."options" AS "perguntas.options", "perguntas"."order" AS "perguntas.order", "perguntas"."required" AS "perguntas.required", "tenant"."id" AS "tenant.id", "tenant"."name" AS "tenant.name", "tenant"."logoUrl" AS "tenant.logoUrl", "tenant"."description" AS "tenant.description", "tenant"."primaryColor" AS "tenant.primaryColor", "tenant"."secondaryColor" AS "tenant.secondaryColor", "roleta"."id" AS "roleta.id", "roleta"."nome" AS "roleta.nome", "roleta"."descricao" AS "roleta.descricao", "roleta"."active" AS "roleta.active" FROM "pesquisas" AS "Pesquisa" LEFT OUTER JOIN "perguntas" AS "perguntas" ON "Pesquisa"."id" = "perguntas"."pesquisaId" LEFT OUTER JOIN "tenants" AS "tenant" ON "Pesquisa"."tenantId" = "tenant"."id" LEFT OUTER JOIN "roletas" AS "roleta" ON "Pesquisa"."roletaId" = "roleta"."id" WHERE "Pesquisa"."id" = '87d63f62-4bb9-43e5-ab76-9eb004d4d2bb';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."phone" = '(35) 99837-4007' AND "Client"."tenantId" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "id", "name", "logoUrl", "primaryColor", "secondaryColor", "description" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "id", "name", "logoUrl", "primaryColor", "secondaryColor", "description" FROM "tenants" AS "Tenant" WHERE "Tenant"."id" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "tenantId" FROM "respostas" AS "Resposta" WHERE "Resposta"."respondentSessionId" = 'a2b6775a-08f6-47db-a0a2-7ddc2343e323' LIMIT 1;
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."email" = 'email@teste.com';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."phone" = '(35) 99837-4007' AND "Client"."tenantId" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."respondentSessionId" = 'a2b6775a-08f6-47db-a0a2-7ddc2343e323';
Executing (483c1344-1336-4315-b6fc-e96e6beda629): INSERT INTO "clients" ("id","tenantId","name","email","phone","birthDate","respondentSessionId","gender","createdAt","updatedAt") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10) RETURNING "id","tenantId","name","email","phone","birthDate","respondentSessionId","gender","createdAt","updatedAt";
Executing (default): SELECT "tenantId" FROM "respostas" AS "Resposta" WHERE "Resposta"."respondentSessionId" = 'a2b6775a-08f6-47db-a0a2-7ddc2343e323' LIMIT 1;
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."email" = 'email@teste.com';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."phone" = '(35) 99837-4007' AND "Client"."tenantId" = '3bd5b49a-56e6-45b7-9710-8d51b8f6e8dd';
Executing (default): SELECT "id", "tenantId", "name", "email", "phone", "birthDate", "respondentSessionId", "gender", "createdAt", "updatedAt" FROM "clients" AS "Client" WHERE "Client"."respondentSessionId" = 'a2b6775a-08f6-47db-a0a2-7ddc2343e323';
Executing (7a271c8a-d590-4484-a119-b055fe6e4936): INSERT INTO "clients" ("id","tenantId","name","email","phone","birthDate","respondentSessionId","gender","createdAt","updatedAt") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10) RETURNING "id","tenantId","name","email","phone","birthDate","respondentSessionId","gender","createdAt","updatedAt";